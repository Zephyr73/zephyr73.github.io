// Gallery page specific styles
.page--gallery .page__content {
  .gallery-tabs {
    display: flex;
    justify-content: center;
    align-items: center;

    a {
      color: var(--clr-body-text);
      text-decoration: none;
    }

    ul {
      display: flex;
      list-style-type: none;
      gap: 20px;
      padding-inline-start: 0;
    }

    &__btn {
      background-color: transparent;
      border: none;
      color: var(--clr-body-text);
      font-family: var(--font-regular);
      font-size: 16px;
      cursor: pointer;

      &.is-active {
        background-color: var(--clr-body-text);
        color: var(--clr-container-bg);
      }
    }
  }

  .gallery-grid--photography,
  .gallery-grid--ai,
  .gallery-grid--forza {
    display: none;
    opacity: 0;
    transition: opacity 0.15s ease;
    flex-direction: row;
    justify-content: space-between;
    align-items: flex-start;
    padding-top: 20px;
    gap: 20px;

    &.is-visible {
      display: flex;
      opacity: 1;
    }

    .gallery-grid__column {
      display: flex;
      flex-direction: column;
      width: 32.5%;
      align-items: center;
      gap: 20px;
      // contain: paint removed — it clips scaled/outlined children at the column boundary,
      // which caused the partial outline lines. contain: layout kept for reflow isolation.
      contain: layout;

      // eleventy-img wraps every <img> in a <picture> element.
      // picture is inline by default — display:block prevents baseline-gap lines
      // at the top/bottom of each image and ensures it stretches to column width.
      picture {
        display: block;
        width: 100%;
      }

      img {
        display: block;
        width: 100%;
        object-fit: cover;
        transform: translateZ(0);
        backface-visibility: hidden;
        // content-visibility: auto removed — causes containment boundary artifacts on img elements
        // and conflicts with the explicit width/height attrs eleventy-img provides
        // hover styles applied via .gallery-item:hover img below
      }

      // ── Gallery item: hover overlay ───────────────────────────────────────
      .gallery-item {
        position: relative;
        width: 100%;
        // flex column removes inline-level whitespace gaps from <picture>;
        // overflow: hidden clips the scaled image cleanly to the item bounds
        display: flex;
        flex-direction: column;
        overflow: hidden;

        &:hover img {
          box-shadow: 0 0 20px 2px rgba(0, 0, 0, 0.2);
          transition: 0.4s ease;
          outline: 1px solid var(--clr-body-text);
          // scale instead of width: 103% — width overflow gets clipped by contain:paint
          // on the column, leaving only top/bottom outline lines visible
          transform: translateZ(0) scale(1.015);
        }

        &__overlay {
          position: absolute;
          inset: 0;
          background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.85) 100%);
          display: flex;
          flex-direction: column;
          justify-content: flex-end;
          align-items: flex-start;
          padding: 14px;
          gap: 10px;
          opacity: 0;
          transition: opacity 0.3s ease;
          pointer-events: none;
        }

        &:hover .gallery-item__overlay {
          opacity: 1;
          pointer-events: auto;
        }

        &__meta {
          display: flex;
          flex-direction: column;
          gap: 3px;
          font-family: var(--font-regular);
          font-size: 11px;
          color: #d8d8d8;
        }

        &__view-details {
          display: inline-block;
          background-color: var(--clr-body-text);
          color: var(--clr-container-bg);
          font-family: var(--font-regular);
          font-size: 12px;
          padding: 6px 14px;
          text-decoration: none;
          cursor: pointer;
          transition:
            background-color 0.2s ease,
            color 0.2s ease;

          &:hover {
            background-color: var(--clr-container-bg);
            color: var(--clr-body-text);
            outline: 1px solid var(--clr-body-text);
          }
        }
      }
    }
  }
}

// Full-width gallery layout on large screens
@media (min-width: 769px) {
  body.is-expanded.page--gallery .page__content,
  body.page--gallery-detail .page__content {
    max-width: calc(100vw - 10%);
  }

  // Nav expands with the gallery page via is-expanded (transition from _nav.scss applies normally).
  // On the detail page the nav is always wide from first paint, so transition: none
  // prevents it animating on load or when navigating back to gallery.
  body.is-expanded.page--gallery .site-nav {
    max-width: calc(100vw - 10%);
  }

  body.page--gallery-detail .site-nav {
    max-width: calc(100vw - 10%);
    transition: none;
  }

  // Opt the content box into View Transitions — GPU compositor handles the size morph,
  // no layout recalculations on every frame (the cause of Chromium jank).
  // The nav is intentionally excluded: fixed/positioned elements captured in VT layers
  // lose stacking context and produce visual artifacts during the transition.
  body.page--gallery .page__content {
    view-transition-name: gallery-content;
  }
}

// Control View Transition animation duration & easing
::view-transition-group(gallery-content) {
  animation-duration: 0.5s;
  animation-timing-function: ease;
}

// Kill the root cross-fade — root contains everything outside the named group
// (including the nav). Old + new root render simultaneously during the default
// fade, which causes a double-nav. Hiding old root and freezing new root means
// the nav instantly shows its final state while only gallery-content animates.
::view-transition-old(root) {
  display: none;
}
::view-transition-new(root) {
  animation: none;
  mix-blend-mode: normal;
}

// Suppress the cross-fade on gallery-content image layers — size morph only
::view-transition-old(gallery-content),
::view-transition-new(gallery-content) {
  animation: none;
  mix-blend-mode: normal;
}

// ── Mobile gallery: moved from layout/_media-queries.scss ────────────────────
@media (max-width: 768px) {
  .page--gallery .page__content .gallery-tabs__btn {
    font-size: 14px;
  }

  .page--gallery .page__content {
    .gallery-grid--photography,
    .gallery-grid--ai,
    .gallery-grid--forza {
      gap: 20px;
      flex-direction: column;

      .gallery-grid__column {
        width: 100%;
      }
    }
  }

  .page--gallery .site-nav__hamburger.active {
    display: block;
  }
}
